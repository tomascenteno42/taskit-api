# Migration `20200712161507-add-subscribed-boards`

This migration has been generated by Teodoro Villanueva at 7/12/2020, 4:15:07 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "TaskStatus" AS ENUM ('COMPLETED', 'IN_PROGRESS', 'PENDING');

CREATE TABLE "public"."User" (
"createdAt" timestamp(3)  NOT NULL ,
"email" text  NOT NULL ,
"id" SERIAL,
"name" text  NOT NULL ,
"password" text  NOT NULL ,
"updatedAt" timestamp(3)   ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Board" (
"authorId" integer  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL ,
"id" SERIAL,
"name" text  NOT NULL ,
"updatedAt" timestamp(3)   ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Task" (
"authorId" integer  NOT NULL ,
"board_id" integer  NOT NULL ,
"content" text  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL ,
"id" SERIAL,
"status" "TaskStatus" NOT NULL ,
"updatedAt" timestamp(3)   ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."_BoardToUser" (
"A" integer  NOT NULL ,
"B" integer  NOT NULL )

CREATE UNIQUE INDEX "User.email" ON "public"."User"("email")

CREATE UNIQUE INDEX "_BoardToUser_AB_unique" ON "public"."_BoardToUser"("A","B")

CREATE  INDEX "_BoardToUser_B_index" ON "public"."_BoardToUser"("B")

ALTER TABLE "public"."Board" ADD FOREIGN KEY ("authorId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Task" ADD FOREIGN KEY ("authorId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Task" ADD FOREIGN KEY ("board_id")REFERENCES "public"."Board"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_BoardToUser" ADD FOREIGN KEY ("A")REFERENCES "public"."Board"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_BoardToUser" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200712155655-create-task..20200712161507-add-subscribed-boards
--- datamodel.dml
+++ datamodel.dml
@@ -1,32 +1,34 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
 }
 model User {
-  id        Int       @id @default(autoincrement())
-  name      String
-  email     String    @unique
-  password  String
-  boards    Board[]
+  id                Int     @id @default(autoincrement())
+  name              String
+  email             String  @unique
+  password          String
+  subscribed_boards Board[] @relation(name: "BoardToUser")
+  boards            Board[] @relation(name: "BoardToAuthor")
+  tasks             Task[]
   createdAt DateTime
   updatedAt DateTime?
-  tasks      Task[]
 }
 model Board {
   id        Int       @id @default(autoincrement())
   name      String
   authorId  Int
-  author    User      @relation(fields: [authorId], references: [id])
+  author    User      @relation(name: "BoardToAuthor",fields: [authorId], references: [id])
+  tasks     Task[]
+  users     User[]    @relation(name: "BoardToUser")
   createdAt DateTime
   updatedAt DateTime?
-  tasks      Task[]
 }
 enum TaskStatus {
   COMPLETED
```


